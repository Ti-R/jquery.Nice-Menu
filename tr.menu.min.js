if(TR==undefined){var TR={}}TR.gCharOpenSubMenu="&#9658;";TR.gEntryGenId=0;TR.NiceMenuItem=function(f,d,c,b,a,e){var g=this;this.mPopup=f;this.mId=d;this.mName=c;this.mOnClick=undefined;this.mShortCut=b;this.mNeedFrontSpace=e||false;if(a){g.mOnClick=a.bind(g)}this.GetShortCut=function(){if(g.mShortCut&&g.mShortCut!=""){return'<div class="menuShortcut">'+g.mShortCut+"</div>"}return""};this.GetDomElement=function(){return g.mPopup.mListDomElements.find("#tr_menu_entry_"+g.mId)};this.GetDomElementInput=function(){return this.GetDomElement().children("input")};this.GetClass=function(){var h="";if(g.mNeedFrontSpace){h+=" frontSpaceNeedEntry"}return h};this.SetClick=function(h){if(g.mOnClick){h.click(g.mOnClick);g.GetDomElementInput().click(function(i){i.stopImmediatePropagation()})}};this.LinkEvents=function(){var h=g.GetDomElement();h.hover(g.mPopup.MenuHover.bind(h));g.SetClick(h);return g}};TR.NiceMenuPopup=function(a,b){var d=this;var c;d.mId=a;if(b){d.mListDomElements=$("#tr_menu_entry_"+a).find(".menuContent")}else{d.mListDomElements=$("#tr_menu_entry_"+a).next(".menuContent")}d.mListItems={};this.AddEntry=function(g,f,e,i){var h=new TR.NiceMenuItem(d,++TR.gEntryGenId,g,f,e,i);d.mListDomElements.append('<span id="tr_menu_entry_'+h.mId+'" class="'+h.GetClass()+'">'+g+h.GetShortCut()+"</span>");d.mListItems[h.mId]=h.LinkEvents();return h.mId};this.AddEntryNoSelection=function(e){var f=new TR.NiceMenuItem(d,++TR.gEntryGenId,e);d.mListDomElements.append('<div id="tr_menu_entry_'+f.mId+'">'+e+"</div>");d.mListItems[f.mId]=f.LinkEvents();return f.mId};this.AddEntryCheckBox=function(g,f,e){var h=new TR.NiceMenuItem(d,++TR.gEntryGenId,g,f,e);d.mListDomElements.append('<label class="menuLabel" id="tr_menu_entry_'+h.mId+'"><input type="checkbox" id="tr_menu_entry_input_'+h.mId+'"><span class="icon"/><span class="menu_text">'+g+"</span>"+h.GetShortCut()+"</label>");d.mListItems[h.mId]=h.LinkEvents();return h.mId};this.AddEntryRadio=function(f,h,g,e){var i=new TR.NiceMenuItem(d,++TR.gEntryGenId,h,g,e);d.mListDomElements.append('<label class="menuLabel" id="tr_menu_entry_'+i.mId+'"><input type="radio" id="tr_menu_entry_input_'+i.mId+'" name="'+f+'"><span class="icon"/><span class="menu_text">'+h+"</span>"+i.GetShortCut()+"</label>");d.mListItems[i.mId]=i.LinkEvents();return i.mId};this.SetEntryCheck=function(e){d.mListItems[e].GetDomElementInput().prop("checked",true)};this.SetEntryUnCheck=function(e){d.mListItems[e].GetDomElementInput().prop("checked",false)};this.SetEntryDisable=function(e){d.mListItems[e].GetDomElement().off("click").addClass("menuDisable")};this.SetEntryEnable=function(e){var f=d.mListItems[e];var g=f.GetDomElement();f.SetClick(domE);g.removeClass("menuDisable")};this.IsEntryCheck=function(e){return d.mListItems[e].GetDomElementInput().is(":checked")};this.AddEntryWithSubMenu=function(e,g){var f=new TR.NiceMenuItem(d,++TR.gEntryGenId,e,"",undefined,g);d.mListDomElements.append('<span class="menuButtonWithSubMenu'+f.GetClass()+'" id="tr_menu_entry_'+f.mId+'"><div class="menuContent menuSubmenu"></div>'+e+'<div class="menuShortcutSubmenu">'+TR.gCharOpenSubMenu+"</div></span>");d.mListItems[f.mId]=f.LinkEvents();return new TR.NiceMenuPopup(f.mId,true)};this.CleanSubMenu=function(e){d.mListDomElements.empty()};this.RemoveEntry=function(e){if(!e){e=a}$("#tr_menu_entry_"+e).remove()};this.MenuHover=function(){if(c!=$(this).children(".menuContent")){$(this).focus();if(c){c.hide()}c=$(this).children(".menuContent");if(c&&!$(this).hasClass("menuDisable")){c.css({left:$(this).outerWidth()});c.show()}}}};TR.NiceMenu=function(b){var e=this;var d=$("#"+b);var f=this.mMenuOpen=false;var c;function a(){if(c){window.focus();c.hide();c=null;d.find(".menuSubmenu").hide()}}this.AddEntry=function(g){++TR.gEntryGenId;d.append('<div class="menuColumn"><button class="menuButton" id="tr_menu_entry_'+TR.gEntryGenId+'">'+g+'</button><div class="menuContent"></div></div>');$("#tr_menu_entry_"+TR.gEntryGenId).click(e.MenuClick).hover(e.MenuHover);return new TR.NiceMenuPopup(TR.gEntryGenId,false)};this.MenuClick=function(){f=!f;c=$(this).next(".menuContent");if(f){c.show()}else{c.hide()}};d.find(".menuButton").click(e.MenuClick);this.MenuHover=function(){if(f){if(c!=$(this).next(".menuContent")){$(this).focus();a();c=$(this).next(".menuContent");c.show()}}};d.find(".menuButton").hover(e.MenuHover);$("body").click(function(){if(!event.target.matches(".menuButton")&&!event.target.matches(".menuButtonWithSubMenu")){a();f=false}})};